
    stages {
        stage('Run Docker Container') {
            steps {
                script {
                    echo 'Stopping and removing any previous containers...'
                    sh '''
                        docker ps -q --filter "name=${DOCKER_IMAGE}" | xargs -r docker stop
                        docker ps -a -q --filter "name=${DOCKER_IMAGE}" | xargs -r docker rm
                    '''

                    echo 'Running new Docker container...'
                    sh '''
                        docker run -d -p ${APP_PORT}:${APP_PORT} --name ${DOCKER_IMAGE} ${DOCKER_IMAGE}:${DOCKER_TAG}
                    '''

                    echo 'Waiting for Docker container logs...'
                    sleep time: 10, unit: 'SECONDS'
                    sh 'docker logs ${DOCKER_IMAGE}'
                }
            }
        }